<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PS5-Style Joystick UI</title>
  <style>
    body {
      margin: 0;
      background: linear-gradient(to bottom right, #0a0a0f, #1f1f2e);
      font-family: 'Segoe UI', sans-serif;
      color: #f2f2f2;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }

    .main-button {
      position: relative;
      width: 200px;
      height: 60px;
      border: none;
      border-radius: 30px;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(12px);
      color: #00ffff;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 1px;
      box-shadow: 0 4px 14px rgba(0, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
      overflow: hidden;
    }

    .main-button:hover {
      background: rgba(0, 255, 255, 0.15);
      box-shadow: 0 6px 24px rgba(0, 255, 255, 0.5);
      color: white;
    }

    .progress-ring {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 56px;
      height: 56px;
      transform: translate(-50%, -50%) rotate(-90deg);
      pointer-events: none;
    }

    .progress-ring circle {
      fill: none;
      stroke-width: 6;
      stroke: #00ffff;
      stroke-linecap: round;
      stroke-dasharray: 157;
      stroke-dashoffset: 157;
      transition: stroke-dashoffset 0.1s linear;
    }

    .status-label {
      margin-top: 20px;
      color: #ccc;
      font-size: 0.95rem;
      height: 20px;
    }
  </style>
</head>
<body>

  <button id="longPressBtn" class="main-button">
    Hold to Navigate
    <svg class="progress-ring">
      <circle r="25" cx="28" cy="28"></circle>
    </svg>
  </button>
  <div id="statusLabel" class="status-label"></div>

  <script>
    const button = document.getElementById('longPressBtn');
    const circle = document.querySelector('.progress-ring circle');
    const status = document.getElementById('statusLabel');
    const fullLength = 157; // 2πr = 2π*25

    let holdStart = null;
    let interval;
    let isHolding = false;

    button.addEventListener('mousedown', () => {
      holdStart = Date.now();
      isHolding = true;
      status.textContent = 'Hold...';
      interval = setInterval(() => {
        const elapsed = (Date.now() - holdStart) / 1000;
        const progress = Math.min(elapsed / 5, 1);
        circle.style.strokeDashoffset = fullLength * (1 - progress);

        if (elapsed >= 3 && elapsed < 5) {
          status.textContent = 'Release now for: Draw in Air';
        } else if (elapsed >= 5) {
          status.textContent = 'Release now for: Test Joystick';
        }
      }, 50);
    });

    button.addEventListener('mouseup', () => {
      if (!isHolding) return;
      const heldFor = (Date.now() - holdStart) / 1000;
      clearInterval(interval);
      circle.style.strokeDashoffset = fullLength;
      status.textContent = '';

      if (heldFor >= 5) {
        window.location.href = '/test.html';
      } else if (heldFor >= 3) {
        window.location.href = '/draw-in-air.html';
      }

      isHolding = false;
    });

    button.addEventListener('mouseleave', () => {
      // Cancel if mouse leaves button
      if (isHolding) {
        clearInterval(interval);
        circle.style.strokeDashoffset = fullLength;
        status.textContent = '';
        isHolding = false;
      }
    });

    // Reset SVG stroke on load
    circle.style.strokeDashoffset = fullLength;
  </script>

</body>
</html>
